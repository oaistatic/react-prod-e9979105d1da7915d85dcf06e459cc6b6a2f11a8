import{j as e,h as L,M as z,g as Q,r as C,m as R}from"./juy90og0wtbp77qa.js";import{a as X,T as Y}from"./9k8yv4dhh02fqujo.js";import{fq as $,bR as F,ek as U,iI as I,c as P,ds as G,dw as O,dx as ee,k5 as te,k6 as ae,k7 as se,bJ as oe,k8 as ne}from"./ckp56qklot786ulr.js";import{u as de,c as le,D as re}from"./du2o33bqvziie5hn.js";import{be as ce,ar as p,aF as j,dG as D,l8 as ie,dM as me,h8 as H}from"./dc2xxjkicf2pz0mj.js";import{r as xe}from"./kinvcw3l5cx6b6nu.js";import{C as W,T as fe}from"./mg2nlgj6x6fpxi63.js";import{g as he}from"./btagl6w1gub4aw61.js";import"./jy1u8exw8iz2slve.js";import"./l7m4sdxmp3n9y1x8.js";import"./f5uxfkqdhg7743lt.js";import"./e2fyqefjfccaah4p.js";function ue({textdocVersion:l,clientThreadId:n}){const{handleCopy:d,copyLabel:i}=de({textdocVersion:l,clientThreadId:n}),c=!ce();return e.jsx($,{onCopy:d,className:"py-1",iconClassName:p("icon-md",!c&&"hidden"),iconOnly:c,buttonText:c?void 0:i})}function be({textdocVersion:l,disabled:n}){const d=L(),{handleFileDownload:i,handleBlobDownload:c,isLoading:m,downloadCopyLabel:h,isDocument:a}=le(l);return a?e.jsxs(j.Root,{open:!m&&!n?void 0:!1,children:[e.jsx(j.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:m||n,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(D,{label:h,children:e.jsx(F,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(j.Portal,{children:e.jsxs(j.Content,{align:"end",children:[e.jsx(j.Item,{onClick:t=>{t.preventDefault(),i("pdf")},children:d.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(j.Item,{onClick:t=>{t.preventDefault(),i("docx")},children:d.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(j.Item,{onClick:t=>{t.preventDefault(),i("md")},children:d.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(D,{label:h,children:e.jsx("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:m||n,onClick:c,children:e.jsx(F,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:m||n,onClick:c,children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function ge({onClick:l}){const n=L();return e.jsxs("button",{className:"flex items-center gap-1 py-1 select-none",onClick:l,children:[e.jsx(D,{label:e.jsx(z,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(U,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:n.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}var T,q;function pe(){if(q)return T;q=1;var l=xe(),n=I(),d=ie(),i=parseFloat,c=Math.min,m=Math.random;function h(a,t,r){if(r&&typeof r!="boolean"&&n(a,t,r)&&(t=r=void 0),r===void 0&&(typeof t=="boolean"?(r=t,t=void 0):typeof a=="boolean"&&(r=a,a=void 0)),a===void 0&&t===void 0?(a=0,t=1):(a=d(a),t===void 0?(t=a,a=0):t=d(t)),a>t){var s=a;a=t,t=s}if(r||a%1||t%1){var u=m();return c(a+u*(t-a+i("1e-"+((u+"").length-1))),t)}return l(a,t)}return T=h,T}var je=pe();const ye=Q(je),ve=({isCanvasHovered:l=!1,onClick:n})=>{const d=L();return e.jsx(D,{label:d.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(oe,{color:l?"primary":"secondary",icon:ne,onClick:n})})},ke=({textdocId:l,clientThreadId:n,name:d,tag:i,icon:c,iconSelected:m,marginBottom:h,size:a="large",height:t=a==="large"?"22rem":"10rem",minHeight:r,isCanvasOpen:s=!1,isDisabled:u=!1,isFocused:b=!1,isInferring:N=!1,isInlinePreview:o=!1,isStreaming:x=!1,isUserMessage:y=!1,onClick:k,children:w})=>{const E=C.useRef(null),[v,S]=C.useState(!1),[V]=C.useState(()=>ye(100,180,!1)),g=me(P(l)?.versions),f=G(),M=!f,_=g==null||x,B=b&&s?m??c:c,J=B?e.jsx("span",{className:p("shrink-0 transition-[filter]",{grayscale:!b&&!v}),children:B}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(H,{lines:1,size:"base",width:100,widthVariance:0})}),A=g?.type&&O(g.type)?X(g.type):void 0,K=!d||N?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:V},children:e.jsx(H,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:p("min-w-0 truncate",{"text-token-text-primary font-semibold":f}),children:d}),f&&A&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",A]})]}),Z=()=>{!E.current||u||(te.logButtonClick(ae.MESSAGE_ATTACHMENT,{type:i}),se(E.current),k?.())};return e.jsxs(R.div,{role:M?"button":void 0,id:he(l),initial:{opacity:x?0:1,scale:x?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:p("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 flex flex-col overflow-hidden border",u?"cursor-default":M?"cursor-pointer":"cursor-text",{"select-none":M,"border-token-text-tertiary font-medium dark:border-gray-600":b&&s,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!o,"rounded-[20px]":!s&&o,"max-w-full":!y&&(s||!o),"max-w-[var(--user-chat-width,70%)]":y&&(s||!o),"w-full":!y&&!s&&o,"w-[var(--user-chat-width,70%)]":y&&!s&&o,"w-full py-3 sm:-mx-6 sm:w-[calc(100%+3rem)] sm:max-w-none":o&&f}),onMouseEnter:()=>!u&&S(!0),onMouseLeave:()=>S(!1),onClick:()=>M?Z():void 0,ref:E,style:{marginBottom:h,height:o&&!s?t:void 0,minHeight:o&&!s?r:void 0,width:a==="small"?"300px":void 0},children:[e.jsxs("div",{className:p("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!v&&!b,"border-token-border-medium":v&&!b,"text-token-text-primary text-sm font-medium":!s&&v&&o,"py-2":s||!o,"py-3":!s&&o,"text-token-text-secondary text-sm font-medium":!s&&!v&&o,"px-4 pt-1 pb-3 sm:px-6":f}),children:[e.jsxs("div",{className:p("flex min-w-0 items-center",{"gap-2":s||!o,"gap-3.5":!s&&o}),children:[!f&&J,K]}),s?e.jsx(R.span,{animate:x?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:x&&e.jsx(Y,{gap:1,padding:0})}):o&&!u?e.jsx("div",{className:p("flex items-center gap-1",{"text-token-text-tertiary gap-4 font-sans text-sm font-normal":f}),children:f?e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ue,{textdocVersion:g??null,clientThreadId:n})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ge,{onClick:k})}),g&&g.type!==ee.LOADING&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(be,{disabled:_,textdocVersion:g})})]}):e.jsx(ve,{isCanvasHovered:v,onClick:k})}):null]}),e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&w,o&&!s&&!f&&e.jsx(W,{size:a,position:"bottom"}),o&&a==="small"&&!s&&!f&&e.jsx(W,{size:a,position:"right"})]})]})},Fe=({textdocId:l,clientThreadId:n,name:d,tag:i,icon:c,iconSelected:m,isCanvasOpen:h=!1,isFetching:a=!1,isFocused:t=!1,isInlinePreview:r=!1,isStreaming:s=!1,isUserMessage:u=!1,onClick:b})=>{const[N,o]=C.useState(!1),x=G(),y=w=>{o(w>0)},k=r&&!h?16:12;return e.jsx(ke,{textdocId:l,name:d,tag:i,icon:c,height:x?"auto":void 0,minHeight:x?"18rem":void 0,iconSelected:m,marginBottom:k,isCanvasOpen:h,isFocused:t,isInlinePreview:r,isStreaming:s,isUserMessage:u,onClick:b,clientThreadId:n,children:r&&e.jsx("div",{className:p("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":N,"border-transparent":!N}),children:a?e.jsx(re,{numLines:x?8:20}):!!l&&e.jsx(fe,{disableScroll:x,onScroll:y,textdocId:l,clientThreadId:n})})})};export{Fe as CanvasMessageAttachment,ke as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=jv64elfmhskul05g.js.map
