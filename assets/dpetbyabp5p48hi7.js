import{B as G,ar as F,eW as ye,C as ke,aq as Se,R as W,ly as x,dN as A,fF as fe,e$ as we,aF as v,aG as ae,D as be,e as ve,dh as _e,en as Ae,cF as Oe,ac as Ge,ag as le,a7 as Re,ll as De,dA as Ee,lz as K,hP as ee,lA as Ie,dG as Pe,j6 as Le}from"./dc2xxjkicf2pz0mj.js";import{r as p,h as I,j as e,M as n,f as Y,u as B,A as Fe,m as We,b as ze,e as Be,a as oe}from"./juy90og0wtbp77qa.js";import{a5 as d,a6 as ie,M as ne,a7 as re,eF as Ue,dB as He,j9 as qe,aW as Ve,iF as Ke,aC as k,e9 as Ye,bz as Qe,ap as Je,bB as $e,lq as Ze,jr as Xe,lr as es,dR as je,iG as ss,S as y}from"./ckp56qklot786ulr.js";import{a as ts,c as as,u as is,d as ns}from"./nun3xvf89dudjv6n.js";import{S as rs}from"./mkoqnr8029hcz5w2.js";import{g as Te}from"./ctoge6bibgzva9ta.js";import{S as ls}from"./m36qabefvxegdn1g.js";import{S as os}from"./ol0j0ogvgt70u6w3.js";import{b as se}from"./bq1weg8hkyprwt4p.js";import{A as cs}from"./jrzcjkd32gzj18rp.js";import{V as ds}from"./d3y72ugnrmac5z1v.js";import{d as ps,e as us,A as ms,a as gs,b as xs,c as hs}from"./nyxt3hy2zzj6sj8a.js";import"./icu9d2zdwlcy45kn.js";import"./btouzu0b6h5eiejj.js";import"./o6wb3ptvu0bk81yq.js";import"./dmfmxszxfbs8gsbx.js";import"./iacposgqe14fuloa.js";import"./o7zrzew6ugefv8n2.js";import"./abebcwj1m9mup3z6.js";import"./nqj34k5dky4x5suq.js";import"./hort3ndd4wla0a2j.js";import"./jsgl3b1bt1ozctr5.js";import"./ck00y48d3yzt8bq3.js";import"./hczymk9ojq2shlcf.js";import"./hisrfv493df9w8hp.js";import"./g8shiwm7jpd74xmd.js";import"./iiyyoj0wgh5vo89i.js";import"./chyo79tmbp42x8r3.js";import"./gvmh4kt4ryn7x9gx.js";import"./oednpha5s5kodcso.js";import"./debx62351e4myexq.js";function fs({value:t,title:s,valueClassName:a,onChange:i,emptyMessage:o}){const[r,c]=p.useState(!1),[h,w]=p.useState(""),P=I(),u=p.useRef(null),m=()=>{if(h!==""){const g=h.trim();i([...t,g]),c(!1),w("")}};return e.jsxs(d.Root,{className:"w-auto",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{children:s}),e.jsx(d.HeaderCell,{})]}),e.jsxs(d.Body,{children:[t.map((g,j)=>e.jsxs(d.Row,{children:[e.jsx(d.Cell,{className:a,children:g}),e.jsx(d.Cell,{textAlign:"right",children:e.jsx(G,{type:"button",onClick:()=>{i(t.filter((b,_)=>_!==j))},children:e.jsx(ie,{className:"icon-sm"})})})]},j)),o&&t.length===0?e.jsx(d.Row,{children:e.jsx(d.Cell,{colSpan:2,className:"text-center text-sm italic",children:o})}):null,e.jsxs(d.Row,{children:[e.jsxs("div",{className:F("mt-2 flex flex-row gap-2 p-1",!r&&"hidden"),children:[e.jsx(ye,{ariaLabel:P.formatMessage({id:"CgP6Du",defaultMessage:"Add new domain"}),className:"w-80",name:"newDomain",value:h,onChange:g=>{w(g.target.value)},ref:u,onPressEnter:m,placeholder:"example.com"}),e.jsx(G,{className:"grow-0",onClick:m,children:e.jsx(n,{id:"svRVol",defaultMessage:"Add"})})]}),!r&&e.jsxs(G,{type:"button",onClick:()=>{c(!0),setTimeout(()=>{u.current?.focus()},0)},className:"mt-2",children:[e.jsx(ne,{className:"icon-sm inline-block"}),e.jsx(n,{id:"J5y3+M",defaultMessage:"Add new domain"})]})]})]})]})}const ws=t=>p.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},p.createElement("path",{d:"M16.0012 5.00031C16.0012 4.44721 15.5533 3.99853 15.0002 3.99835H5.00024C4.44704 3.99835 3.99829 4.4471 3.99829 5.00031V5.97589C3.99829 6.24153 4.10343 6.49703 4.29126 6.68488L7.48169 9.87531L7.63696 10.0462C7.97685 10.4611 8.16528 10.9827 8.16528 11.5237V15.1663C8.16528 15.3016 8.2465 15.4239 8.37134 15.4759L11.3713 16.7259C11.592 16.8177 11.8352 16.6553 11.8352 16.4163V11.5237C11.8352 10.9055 12.0807 10.3126 12.5178 9.87531L15.7083 6.68488L15.7747 6.61066C15.9206 6.43245 16.0012 6.20824 16.0012 5.97589V5.00031ZM17.3313 5.97589C17.3313 6.517 17.1439 7.03949 16.804 7.45441L16.6487 7.62531L13.4583 10.8157C13.2706 11.0036 13.1653 11.2582 13.1653 11.5237V16.4163C13.1653 17.6044 11.9563 18.4104 10.8596 17.9534L7.85962 16.7034C7.23919 16.4449 6.83521 15.8385 6.83521 15.1663V11.5237C6.83521 11.2581 6.72911 11.0036 6.54126 10.8157L3.35083 7.62531C2.91358 7.18804 2.66821 6.59427 2.66821 5.97589V5.00031C2.66821 3.71256 3.7125 2.66827 5.00024 2.66827H15.0002C16.2878 2.66845 17.3313 3.71267 17.3313 5.00031V5.97589Z"}));function js({isOpen:t,onClose:s,account:a,gpt:i}){const o=I(),[r,c]=p.useState(!1),[h,w]=p.useState(""),[P,u]=p.useState(!0),m=i.gizmo.is_unassigned;return e.jsxs(ke,{testId:"modal-change-owner",size:"custom",className:"max-w-lg text-sm",isOpen:t,onClose:Se,type:"success",title:o.formatMessage(m?E.assignModalTitle:E.changeModalTitle),children:[e.jsx("p",{className:"text-token-text-primary mb-4",children:e.jsx(n,{...E.changeModalPrompt,values:{gptName:i.gizmo.display.name}})}),!P&&e.jsx("p",{className:"text-red-500",children:e.jsx(n,{...E.invalidEmail})}),e.jsx(ye,{ariaLabel:o.formatMessage({id:"x4A5l2",defaultMessage:"Email"}),className:F("px-3 py-2",P?"":"border-red-500"),name:"email",type:"email",value:h,placeholder:"Email",onChange:g=>{w(g.target.value)}}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(G,{color:"secondary",onClick:()=>{s(!1),c(!1),u(!0)},loading:r,children:e.jsx(n,{...E.cancelButtonText})}),e.jsx(G,{color:"primary",loading:r,onClick:()=>{c(!0),u(!0),h==""||!ds.test(h)?(u(!1),c(!1)):W.safePost("/accounts/{account_id}/gpts/{gizmo_id}/owner",{parameters:{path:{account_id:a.id,gizmo_id:i.gizmo.id}},requestBody:{email:h}}).then(()=>{s(!0),c(!1),u(!0)},()=>{u(!1),c(!1)})},children:e.jsx(n,{...m?E.assignButtonText:E.changeOwnerButtonText})})]})]})}const E=Y({changeModalTitle:{id:"changeOwnerModal.changeModalTitle",defaultMessage:"Change Owner"},assignModalTitle:{id:"changeOwnerModal.assignModalTitle",defaultMessage:"Assign Owner"},changeModalPrompt:{id:"changeOwnerModal.changeModalPrompt",defaultMessage:"New owner of {gptName}"},cancelButtonText:{id:"changeOwnerModal.cancelButtonText",defaultMessage:"Cancel"},changeOwnerButtonText:{id:"changeOwnerModal.changeOwnerButtonText",defaultMessage:"Change owner"},assignButtonText:{id:"changeOwnerModal.assignButtonText",defaultMessage:"Assign"},invalidEmail:{id:"changeOwnerModal.invalidEmail",defaultMessage:"Email is invalid or does not belong to a member in this workspace"}});function Ts({isOpen:t,onClose:s,account:a,gpt:i}){const o=I(),[r,c]=p.useState(!1);return e.jsxs(ke,{testId:"modal-delete-gpt",size:"custom",className:"max-w-lg text-sm",isOpen:t,onClose:Se,type:"success",title:o.formatMessage(V.deleteModalTitle),children:[e.jsx("p",{className:"text-token-text-primary mb-4",children:e.jsx(n,{...V.deleteModalPrompt,values:{gptName:i.gizmo.display.name}})}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(G,{color:"secondary",onClick:()=>{s(!1)},loading:r,children:e.jsx(n,{...V.cancelButtonText})}),e.jsx(G,{color:"danger",loading:r,onClick:()=>{c(!0),W.safeDelete("/accounts/{account_id}/gpts/{gizmo_id}",{parameters:{path:{account_id:a.id,gizmo_id:i.gizmo.id}}}).finally(()=>{s(!0),c(!1)})},children:e.jsx(n,{...V.deleteButtonText})})]})]})}const V=Y({deleteModalTitle:{id:"deleteGPTModal.accessModalTitle",defaultMessage:"Delete GPT"},deleteModalPrompt:{id:"deleteGPTModal.accessModalPrompt",defaultMessage:"Are you sure you would like to delete {gptName}? This action can not be undone."},cancelButtonText:{id:"deleteGPTModal.cancelButtonText",defaultMessage:"Cancel"},deleteButtonText:{id:"deleteGPTModal.deleteButtonText",defaultMessage:"Delete"}}),z=10;function ys({account:t,gpt:s,thirdParty:a}){const i=B(),o=ve(),[r,c]=p.useState(!1),[h,w]=p.useState(!1),[P,u]=p.useState(!1),[m,g]=p.useState(!1),j=Be(),b=new Date(a?s.gizmo.workspace_approval_date??"":s.gizmo.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"}),_=new Date(s.gizmo.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric"}),C=p.useMemo(()=>{const S=s.tools.filter(M=>M.type===A.JIT_PLUGIN).map(M=>M.type===A.JIT_PLUGIN?M.metadata.domain:"");return S.length===1?S[0]:S.length>1?`${S.length} domains`:""},[s.tools]),O=s.gizmo.is_unassigned;return e.jsxs(e.Fragment,{children:[e.jsxs(d.Row,{className:"relative",children:[e.jsx(d.Cell,{className:"max-w-[320px] min-w-[240px] py-2 pe-2 align-middle! whitespace-break-spaces",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 shrink-0",children:e.jsx(Ye,{src:s.gizmo.display.profile_picture_url,isFirstParty:s.gizmo.tags?.includes(Qe.FirstParty)??!1,alt:s.gizmo.display.name,className:"h-10 w-10"})}),e.jsx(_e,{className:"ms-4",onClick:()=>j(Je(o,s)),children:e.jsx("div",{className:"text-token-text-primary text-sm font-semibold",children:s.gizmo.display.name})})]})}),e.jsx(d.Cell,{className:"text-token-text-secondary w-full max-w-[160px] min-w-[100px] p-2 align-middle! text-sm",children:O?e.jsx("div",{className:"bg-token-bg-tertiary rounded-lg px-2 py-1",children:e.jsx(n,{...l.unassigned})}):e.jsx("span",{className:"block overflow-hidden text-ellipsis whitespace-nowrap",children:s.gizmo.author.display_name})}),e.jsx(d.Cell,{wrap:!0,className:"text-token-text-secondary max-w-[240px] min-w-[160px] p-2 align-middle! text-sm",children:C===""?"â€”":C}),!a&&e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:e.jsx(Ns,{gizmo:s,account:t})}),!a&&e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:s.gizmo.vanity_metrics?.num_conversations_str??0}),e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:b}),e.jsx(d.Cell,{className:"text-token-text-secondary p-2 align-middle! text-sm whitespace-nowrap",children:_}),e.jsx(d.Cell,{className:"border-token-border-heavy bg-token-bg-primary sticky end-0 border-s-[0.5px] p-1 align-middle!",textAlign:"center",children:e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{children:e.jsx(Ae,{className:"icon-sm"})}),e.jsx(v.Portal,{children:a?e.jsx(v.Content,{children:e.jsx(v.Item,{onClick:()=>{g(!0)},color:"danger",icon:ie,children:e.jsx(n,{...l.removeFromWorkspace})})}):e.jsxs(v.Content,{children:[e.jsx(v.Item,{onClick:()=>{c(s)},icon:ls,children:e.jsx(n,{...l.changeAccess})}),e.jsx(v.Item,{onClick:()=>{u(!0)},icon:O?$e:Oe,children:e.jsx(n,{...O?l.assignOwner:l.changeOwner})}),e.jsx(v.Item,{onClick:()=>{w(!0)},icon:ie,color:"danger",children:e.jsx(n,{...l.deleteGPT})})]})})]})})]}),r&&e.jsx(os,{publishedGizmo:r,gizmo:Ze(r),onClose:()=>c(!1),appealGizmo:()=>j(Xe(r.gizmo.id)),shareOnly:!0,workspaceOwner:!0}),e.jsx(js,{isOpen:P,gpt:s,account:t,onClose:S=>{u(!1),S&&i.invalidateQueries({queryKey:["workspace",t.id,x.WORKSPACE]})}}),e.jsx(Ts,{isOpen:h,gpt:s,account:t,onClose:S=>{w(!1),S&&i.invalidateQueries({queryKey:["workspace",t.id,x.WORKSPACE]})}}),e.jsx(es,{isOpen:m,gpt:s,account:t,onClose:S=>{g(!1),S&&i.invalidateQueries({queryKey:["workspace",t.id,x.THIRD_PARTY]})}})]})}function ks(t,s,a){return t.sort((i,o)=>{let r,c;if(s==="created_at")r=new Date(i.gizmo.created_at).getTime(),c=new Date(o.gizmo.created_at).getTime();else if(s==="updated_at")r=new Date(i.gizmo.updated_at).getTime(),c=new Date(o.gizmo.updated_at).getTime();else if(s==="workspace_approval_date")r=new Date(i.gizmo.workspace_approval_date??"").getTime(),c=new Date(o.gizmo.workspace_approval_date??"").getTime();else if(s==="vanity_metrics.num_conversations_str")r=i.gizmo.vanity_metrics?.num_conversations??0,c=o.gizmo.vanity_metrics?.num_conversations??0;else throw new Error(`Invalid field: ${s}`);if(a==="asc")return r-c;if(a==="desc")return c-r;throw new Error(`Invalid direction: ${a}`)})}function Ss(t){switch(t){case k.User:case k.Group:return k.Private;case k.WorkspaceLink:return k.Workspace;default:return t}}function vs(t,s){return t.filter(a=>{const i=a.tools.some(c=>c.type===A.MEMORY?!1:s.tools[c.type]),o=Ss(a.gizmo.share_recipient),r=s.share_recipient[o];return i||r})}function Ps(t,s){const a=s.toLowerCase();return t.filter(({gizmo:i})=>{const o=i.author.display_name,r=i.display.name.toLowerCase();return o?.toLowerCase().includes(a)||r.includes(a)})}const Ms=({account:t,showThirdParty:s})=>{const[a,i]=p.useState(x.WORKSPACE),{data:o,fetchNextPage:r,hasNextPage:c,isError:h,isFetchingNextPage:w}=Cs(t.id,a),P=I(),[u,m]=p.useState(!1),g=o?.pages.flatMap(T=>T.items)??[];p.useEffect(()=>{!h&&!w&&c&&r()},[w,c,h,r]);const j=c,b=p.useRef(null),[_,C]=p.useState(""),[O,S]=p.useState(!1),[M,Me]=p.useState("updated_at"),[U,ce]=p.useState("desc"),Q=U==="asc"?He:qe,de={tools:{[A.BROWSER]:!1,[A.PYTHON]:!1,[A.JIT_PLUGIN]:!1,[A.RETRIEVAL]:!1,[A.DALLE]:!1,[A.IMAGE_GEN]:!1,[A.CANVAS]:!1},share_recipient:{[k.Private]:!1,[k.Workspace]:!1,[k.Link]:!1,[k.Marketplace]:!1}},[L,pe]=p.useState(de),[J,H]=p.useState(0),Ce=B();p.useEffect(()=>{O&&b.current&&b.current.focus()},[O]);function ue(T,R){const{id:D,checked:Ne}=T.currentTarget,he={...L};he[R][D]=Ne,pe(he),H(0)}function $(T){const R=M,D=U;M===T?ce(U==="asc"?"desc":"asc"):(Me(T),ce("desc")),be.addAction("workspace_gpt_table_sorting",{column:T,previousSort:R,previousDirection:D,newDirection:R===M?D==="asc"?"desc":"asc":"desc"})}let me=0,ge=0;const Z=Object.values(L.tools).filter(Boolean).length+Object.values(L.share_recipient).filter(Boolean).length;let N=[],xe=0;const q=o===void 0,X=!q&&g.length>0;return q||(xe=Math.min(g.length,z),ge=Math.ceil(g.length/z),j?N=g:N=ks(g,M,U),_!==""&&(N=Ps(N,_)),Z>0&&(N=vs(N,L)),me=Math.ceil(N.length/z),N=N.slice(J*z,(J+1)*z)),e.jsxs("div",{children:[e.jsxs("div",{className:"border-token-border-default flex justify-between border-b",children:[e.jsxs("div",{className:"flex space-x-4 pt-2",children:[e.jsx(se,{isActive:a===x.WORKSPACE,onClick:()=>i(x.WORKSPACE),children:e.jsx(n,{...l.workspaceTab})}),s&&e.jsx(se,{isActive:a===x.THIRD_PARTY,onClick:()=>i(x.THIRD_PARTY),children:e.jsx(n,{...l.thirdPartyTab})}),e.jsx(se,{isActive:a===x.UNASSIGNED,onClick:()=>i(x.UNASSIGNED),children:e.jsx(n,{...l.unassigned})})]}),!q&&e.jsxs("div",{className:"flex items-center pb-2",children:[Z>0&&e.jsxs(fe,{className:"flex items-center space-x-1",onClick:()=>pe(de),children:[e.jsx("span",{className:"font-medium",children:e.jsx(n,{id:"2HkRen",defaultMessage:"{filterCount, plural, one {# filter} other {# filters}} applied",values:{filterCount:Z}})}),e.jsx(we,{className:"icon"})]}),e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{children:e.jsx(ws,{className:"icon"})}),e.jsx(v.Portal,{children:e.jsx(v.Content,{className:"rounded-lg px-2 text-sm",children:e.jsxs("div",{className:"text-token-text-primary w-64 space-y-2 p-2 font-normal",children:[e.jsxs("div",{className:"flex-col space-y-2",children:[e.jsx("span",{className:"flex font-semibold",children:e.jsx(n,{...l.capabilitiesTitle})}),Object.entries(L.tools).map(([T,R])=>e.jsx(re,{id:T,checked:R,label:Te(t,T),onChange:D=>{ue(D,"tools")}},T))]}),e.jsxs("div",{className:"flex-col space-y-2",children:[e.jsx("span",{className:"flex font-semibold",children:e.jsx(n,{...l.whoHasAccessTitle})}),Object.entries(L.share_recipient).map(([T,R])=>e.jsx(re,{id:T,checked:R,label:Te(t,T),onChange:D=>{ue(D,"share_recipient")}},T))]})]})})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{onClick:()=>S(!0),children:e.jsx(Ue,{className:"icon"})}),e.jsx(Fe,{children:O&&e.jsx(We.input,{type:"text",ref:b,placeholder:P.formatMessage(l.filterByNameOrBuilderPlaceholder),className:"bg-token-bg-primary border-none px-0 focus:ring-0",initial:{width:0,opacity:0},animate:{width:"192px",opacity:1},exit:{width:0,opacity:0,visibility:"hidden"},value:_,onChange:()=>{H(0),C(b.current?.value??"")}})}),O&&e.jsx("div",{className:"cursor-pointer",onClick:()=>{S(!1),C(""),H(0)},children:e.jsx(we,{className:"icon-sm"})})]}),s&&e.jsx(G,{color:"secondary",onClick:()=>m(!0),icon:ne,children:e.jsx(n,{...l.approveAGPTButton})})]})]}),q?e.jsx("div",{className:"mt-8 flex min-h-[320px] items-center justify-center",children:e.jsx(ae,{})}):e.jsxs("div",{style:{height:xe*85+75},className:"mb-8 min-h-[320px]",children:[N.length>0?e.jsxs(d.Root,{size:"normal",className:"bg-token-bg-primary w-full min-w-full overflow-hidden overflow-x-auto sm:rounded-lg",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"text-token-text-secondary py-2 pe-4 text-start text-xs",children:e.jsx(n,{...l.nameCellTitle})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary px-2 py-2 text-start text-xs",children:e.jsx(n,{...l.builderCellTitle})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary px-2 py-2 text-start text-xs",children:e.jsx(n,{...l.customActionsCellTitle})}),(a===x.WORKSPACE||a===x.UNASSIGNED)&&e.jsx(d.HeaderCell,{className:"text-token-text-secondary px-2 py-2 text-start text-xs",children:e.jsx(n,{...l.whoHasAccessTitle})}),(a===x.WORKSPACE||a===x.UNASSIGNED)&&e.jsx(d.HeaderCell,{className:"text-token-text-secondary cursor-pointer px-2 py-2 text-start text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{j||$("vanity_metrics.num_conversations_str")},children:[e.jsx("span",{children:e.jsx(n,{...l.chatsCellTitle})}),M==="vanity_metrics.num_conversations_str"&&e.jsx(Q,{className:F("icon-sm",j&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary cursor-pointer px-2 py-2 text-start text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{j||$("created_at")},children:[e.jsx("span",{children:a===x.WORKSPACE||a===x.UNASSIGNED?e.jsx(n,{...l.createdCellTitle}):e.jsx(n,{...l.approvedCellTitle})}),M==="created_at"&&e.jsx(Q,{className:F("icon-sm",j&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"text-token-text-secondary cursor-pointer px-2 py-2 text-start text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",onClick:()=>{j||$("updated_at")},children:[e.jsx("span",{children:e.jsx(n,{...l.updatedCellTitle})}),M==="updated_at"&&e.jsx(Q,{className:F("icon-sm",j&&"opacity-30")})]})}),e.jsx(d.HeaderCell,{className:"border-token-border-heavy absolute end-0 w-16 border-s-[0.5px]"})]}),e.jsx(d.Body,{children:N.map(T=>e.jsx(ys,{account:t,gpt:T,thirdParty:a===x.THIRD_PARTY},T.gizmo.id))})]}):e.jsxs("div",{className:"flex h-full w-full flex-col items-center gap-4 py-16",children:[e.jsx("div",{children:e.jsx(Ve,{className:"h-12 w-12 text-gray-400"})}),e.jsx("p",{className:"text-token-text-secondary",children:!j&&(a===x.THIRD_PARTY?e.jsx(n,{...X?l.noWorkspaceApprovedGPTsFound:l.noWorkspaceApprovedGPTs}):a===x.UNASSIGNED?e.jsx(n,{...X?l.noUnassignedGPTs:l.noUnassignedGPTsFound}):e.jsx(n,{...X?l.noWorkspaceGPTsFound:l.noWorkspaceGPTs}))}),a===x.THIRD_PARTY&&e.jsx(G,{color:"secondary",onClick:()=>m(!0),icon:ne,children:e.jsx(n,{...l.approveAGPTButton})})]}),j&&e.jsxs("div",{className:"text-token-text-tertiary my-4 flex w-full items-center justify-center gap-4",children:[e.jsx(ae,{}),e.jsx(n,{...l.stillLoadingData})]}),ge>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Ke,{currentPage:J,onChangeIndex:H,length:Math.max(me,1)})})]}),e.jsx(cs,{isOpen:u,onClose:()=>{m(!1),Ce.invalidateQueries({queryKey:["workspace",t.id,x.THIRD_PARTY]})},account:t})]})};function Cs(t,s){return ze({queryKey:["workspace",t,"gizmos",s],queryFn:async({pageParam:a})=>{const i=s===x.THIRD_PARTY,o=s===x.UNASSIGNED,r=await W.safeGet("/accounts/{account_id}/gpts",{parameters:{path:{account_id:t},query:{is_approved:i,cursor:a,is_unassigned:o}}});return{total:r.total_count??0,items:r.items,cursor:r.cursor??null}},initialPageParam:"",getNextPageParam:a=>a.cursor})}function Ns({gizmo:t,account:s}){const a=I(),i={[k.Private]:a.formatMessage(l.shareRecipientTitlePrivate),[k.User]:a.formatMessage(l.shareRecipientTitlePrivate),[k.Group]:a.formatMessage(l.shareRecipientTitlePrivate),[k.Link]:a.formatMessage(l.shareRecipientTitleLink),[k.Marketplace]:a.formatMessage(l.shareRecipientTitlePublic),[k.Workspace]:s.data.name,[k.WorkspaceLink]:s.data.name};if(["private","user","group"].includes(t.gizmo.sharing.recipient)){const{users:o,groups:r}=bs(t);return o===0&&r===0?e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(n,{...l.shareRecipientTitlePrivate})}):o>0&&r>0?e.jsxs("span",{className:"text-token-text-secondary",children:[i[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(n,{id:"fQ+tJG",defaultMessage:"Shared with {users} and {groups}",values:{users:a.formatMessage(l.userCount,{numUsers:o}),groups:a.formatMessage(l.groupCount,{numGroups:r})}})]}):o>0?e.jsxs("span",{className:"text-token-text-secondary",children:[i[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(n,{...l.userCount,values:{numUsers:o}})]}):e.jsxs("span",{className:"text-token-text-secondary",children:[i[t.gizmo.share_recipient],e.jsx("br",{}),e.jsx(n,{...l.groupCount,values:{numGroups:r}})]})}return e.jsx("span",{children:i[t.gizmo.share_recipient]})}function bs(t){if(t.gizmo.sharing.subjects){const s=t.gizmo.sharing.subjects.filter(i=>i.type===je.USER).length,a=t.gizmo.sharing.subjects.filter(i=>i.type===je.GROUP).length;return{users:s,groups:a}}return{users:0,groups:0}}const l=Y({stillLoadingData:{id:"workspaceSettings.stillLoadingData",defaultMessage:"Don't see what you're looking for? Some GPTs are still loading..."},noUnassignedGPTs:{id:"workspaceSettings.noUnassignedGPTs",defaultMessage:"No unassigned GPTs"},noUnassignedGPTsFound:{id:"workspaceSettings.noUnassignedGPTsFound",defaultMessage:"No unassigned GPTs found"},noWorkspaceGPTs:{id:"workspaceSettings.noWorkspaceGPTs",defaultMessage:"This workspace does not have any GPTs"},noWorkspaceGPTsFound:{id:"workspaceSettings.noWorkspaceGPTsFound",defaultMessage:"No workspace GPTs found"},noWorkspaceApprovedGPTs:{id:"workspaceSettings.noWorkspaceApprovedGPTs",defaultMessage:"You haven't approved any third-party GPTs"},noWorkspaceApprovedGPTsFound:{id:"workspaceSettings.noWorkspaceApprovedGPTsFound",defaultMessage:"No approved third-party GPTs found"},workspaceTab:{id:"workspaceSettings.workspaceTab",defaultMessage:"Workspace"},thirdPartyTab:{id:"workspaceSettings.thirdPartyTab",defaultMessage:"Third-party"},capabilitiesTitle:{id:"workspaceSettings.capabilitiesTitle",defaultMessage:"Capabilities"},whoHasAccessTitle:{id:"workspaceSettings.whoHasAccessTitle",defaultMessage:"Who has access"},filterByNameOrBuilderPlaceholder:{id:"workspaceSettings.filterByNameOrBuilderPlaceholder",defaultMessage:"Filter by name or builder..."},nameCellTitle:{id:"workspaceSettings.nameCellTitle",defaultMessage:"Name"},builderCellTitle:{id:"workspaceSettings.builderCellTitle",defaultMessage:"Builder"},customActionsCellTitle:{id:"workspaceSettings.customActionsCellTitle",defaultMessage:"Custom Actions"},chatsCellTitle:{id:"workspaceSettings.chatsCellTitle",defaultMessage:"Chats"},createdCellTitle:{id:"workspaceSettings.createdCellTitle",defaultMessage:"Created"},updatedCellTitle:{id:"workspaceSettings.updatedCellTitle",defaultMessage:"Updated"},approvedCellTitle:{id:"workspaceSettings.approvedCellTitle",defaultMessage:"Approved"},approveAGPTButton:{id:"workspaceSettings.approveAGPTButton",defaultMessage:"Approve a GPT"},shareRecipientTitlePrivate:{id:"vyjlzc",defaultMessage:"Invite only"},shareRecipientTitleLink:{id:"workspaceSettings.shareRecipientTitleLink",defaultMessage:"Link"},shareRecipientTitlePublic:{id:"workspaceSettings.shareRecipientTitlePublic",defaultMessage:"Public"},changeAccess:{id:"workspaceSettings.changeAccess",defaultMessage:"Change who has access"},changeOwner:{id:"workspaceSettings.changeOwner",defaultMessage:"Change Owner"},assignOwner:{id:"workspaceSettings.assignOwner",defaultMessage:"Assign Owner"},deleteGPT:{id:"workspaceSettings.deleteGPT",defaultMessage:"Delete GPT"},removeFromWorkspace:{id:"workspaceSettings.removeFromWorkspace",defaultMessage:"Remove from workspace"},userCount:{id:"P1xo2B",defaultMessage:"{numUsers, plural, one {# user} other {# users}}"},groupCount:{id:"4zRUED",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},unassigned:{id:"workspaceSettings.unassignedGPTs",defaultMessage:"Unassigned"}});function te({title:t,description:s,children:a,upsellEnterprise:i=!1,isQuorum:o=!1,className:r=""}){return e.jsx(Pe,{label:e.jsx(n,{...f.enterpriseRequiredMessage}),side:"top",disabled:!i,className:"max-w-5xl",triggerAs:null,children:e.jsxs(ms,{className:F(i&&"text-token-text-tertiary","max-w-4xl",r),children:[e.jsxs(gs,{className:"flex items-center gap-3",children:[e.jsx(n,{...t}),i&&e.jsx("span",{className:"bg-token-main-surface-tertiary rounded-xl px-2 pb-0.5 text-sm",children:e.jsx(n,{...f.enterpriseUpsellPill})}),!i&&o&&e.jsx("span",{className:"bg-token-main-surface-tertiary rounded-xl px-3 ps-3 pt-1 pb-1 text-sm font-normal",children:e.jsx(n,{...f.thisFeatureDisabledForOrg})})]}),s&&e.jsx(xs,{className:"text-token-text-secondary py-2",children:e.jsx(n,{...s})}),a]})})}function _s({workspaceId:t,label:s,setting:a,defaultValue:i,values:o,disabled:r=!1}){const c=le(),h=B(),{variables:w,mutate:P}=oe({mutationFn:({setting:u,value:m})=>W.safePost("/accounts/{account_id}/settings/share_settings",{parameters:{path:{account_id:t}},requestBody:{setting:u,value:m}}),onSettled:()=>{h.invalidateQueries({queryKey:["workspace-settings"]}),h.invalidateQueries({queryKey:["workspace"]})},onError:()=>{c.danger(f.featureSettingsUpdateFailed,{toastId:"workspace_gpt_settings_page"})}});return e.jsxs(hs,{children:[e.jsx("p",{className:"text-md inline-flex items-center",children:e.jsx(n,{...s})}),e.jsxs(y.Root,{defaultValue:w?.value??i,onValueChange:u=>{P({setting:a,value:u})},disabled:r,children:[e.jsxs(y.Trigger,{className:"text-md focus-visible:border-none",children:[e.jsx(y.Value,{}),e.jsx(y.Icon,{})]}),e.jsx(y.Portal,{children:e.jsx(y.Content,{children:o.map((u,m)=>e.jsx(y.Item,{className:"text-md",value:u.value,children:e.jsx(n,{...u.display})},m))})})]})]})}function As({workspaceId:t,value:s,upsellEnterprise:a=!1,isQuorum:i=!1}){const o=le(),r=B(),{variables:c,mutate:h}=oe({mutationFn:({value:w})=>W.safePost("/accounts/{account_id}/settings/third_party_gpts",{parameters:{path:{account_id:t}},requestBody:{value:w}}),onSettled:()=>{r.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{o.danger(f.featureSettingsUpdateFailed,{toastId:"third_party_gpt_setting_dropdown"})}});return e.jsxs(y.Root,{defaultValue:c?.value??s,onValueChange:w=>{h({value:w})},children:[e.jsxs(y.Trigger,{className:"border-token-border-default focus-visible:border-token-border-default border text-base",children:[e.jsx(y.Value,{}),e.jsx(y.Icon,{})]}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{children:[!i&&e.jsx(y.Item,{className:"text-base",value:K.ALLOW_ALL,children:e.jsx(n,{...f.allowAllOption})}),!a&&!i&&e.jsx(y.Item,{className:"text-base",value:K.ALLOW_SPECIFIC,children:e.jsx(n,{...f.ownerApprovedOnlyOption})}),e.jsx(y.Item,{className:"text-base",value:K.ALLOW_NONE,children:e.jsx(n,{...f.dontAllowOption})})]})})]})}function Os({workspaceId:t,data:s}){const a=ve(),i=I(),o=le(),r=Re(),c=B(),h=De(),[w,P]=p.useState([]),u=oe({mutationFn:({value:C})=>W.safePost("/accounts/{account_id}/settings/allowed_custom_actions_domains",{parameters:{path:{account_id:t}},requestBody:{domains:C}}),onSettled:()=>{c.invalidateQueries({queryKey:["workspace-settings"]})},onError:()=>{o.danger(f.featureSettingsUpdateFailed,{toastId:"workspace_settings"})}});if(r==null)return null;const m=r.isTeam(),g=Ee(a),j=e.jsx(te,{title:f.thirdPartyGPTsTitle,description:f.thirdPartyGPTsDescription,className:"border-token-border-default border-b pb-4",isQuorum:g,children:e.jsx("div",{children:e.jsx(As,{workspaceId:t,value:s.allow_third_party_gpts,upsellEnterprise:m,isQuorum:g})})}),b=e.jsx(te,{title:f.sidebarTitle,children:e.jsx(Ms,{account:r,showThirdParty:!m&&!g&&s.allow_third_party_gpts===K.ALLOW_SPECIFIC})}),_=s.allowed_custom_actions_domains!=null||s.beta_settings.workspace_gpt_custom_actions===!1;return e.jsxs(ps,{className:"max-w-5xl",children:[m&&!h&&j,m&&r.isOwnerOfAccount()&&b,e.jsx(te,{title:f.sharingSettingsTitle,upsellEnterprise:m,isQuorum:g,children:e.jsxs(us,{children:[!h&&e.jsx(_s,{workspaceId:t,label:f.gptSharingTitle,disabled:m||g,setting:Ie.GPT_SHARE_SETTINGS,defaultValue:s.share_settings.gpt_share_setting,values:[{display:f.anyOneSelect,value:ee.ANYONE},{display:f.workspaceMembersOnlySelect,value:ee.WORKSPACE_ONLY},{display:f.inviteOnlySelect,value:ee.NO_ONE}]}),e.jsx(e.Fragment,{children:!g&&e.jsxs("div",{className:"flex flex-col gap-4 py-6",children:[e.jsx("div",{className:"text-xl font-semibold",children:e.jsx(n,{id:"ugI3Yt",defaultMessage:"GPT actions"})}),e.jsx("div",{className:"text-token-text-secondary py-2 text-sm",children:e.jsx(n,{id:"HY2eof",defaultMessage:"GPT actions allow GPTs to call third-party APIs for tasks such as retrieving or modifying data. GPT actions are defined by GPT builders, and you can limit the domains that can be used for GPTs created in your workspace."})}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx(re,{checked:!_,id:"allow-all-domains",onChange:C=>{C.currentTarget.checked?(P(s.allowed_custom_actions_domains),u.mutate({value:null})):u.mutate({value:w??[]})},label:e.jsxs("span",{className:"flex flex-row items-center",children:[e.jsx(n,{id:"WnWoqJ",defaultMessage:"Allow all domains for GPT actions"}),e.jsx(Pe,{interactive:!0,label:e.jsx(n,{id:"KjJtEm",defaultMessage:"Limit the Internet domains that can be used by GPTs created in your workspace. This does not apply to third-party GPTs."}),side:"top",children:e.jsx(rs,{})})]})}),u.isPending&&e.jsx(ae,{})]}),_&&e.jsx(fs,{value:s.allowed_custom_actions_domains??[],title:i.formatMessage({id:"YetDcq",defaultMessage:"Domains"}),onChange:C=>{u.mutate({value:C})},emptyMessage:i.formatMessage({id:"rFH4IP",defaultMessage:"No domains added. No GPT actions will be allowed."})})]})})]})}),!m&&!h&&j,!m&&r.isOwnerOfAccount()&&b]})}function Gs({currentWorkspaceId:t}){const{data:s,isLoading:a}=Ge(t),i=I();return e.jsxs(e.Fragment,{children:[e.jsx(ss,{children:e.jsx("title",{children:i.formatMessage(f.sidebarTitle)})}),e.jsx(ts,{title:i.formatMessage(f.sidebarTitle)}),e.jsx(as,{showSpinner:a,children:s===void 0?null:e.jsx(Os,{workspaceId:t,data:s})})]})}const f=Y({sidebarTitle:{id:"workspaceSettingsOld.sidebarTitle",defaultMessage:"GPTs"},allowAllOption:{id:"workspaceSettingsOld.allowAllOption",defaultMessage:"Allow all"},ownerApprovedOnlyOption:{id:"workspaceSettingsOld.ownerApprovedOnlyOption",defaultMessage:"Owner-approved only"},dontAllowOption:{id:"workspaceSettingsOld.dontAllowOption",defaultMessage:"Don't allow"},retentionPolicyTitle:{id:"workspaceSettingsOld.retentionPolicyTitle",defaultMessage:"Retention policy"},thirdPartyGPTsTitle:{id:"workspaceSettingsOld.thirdPartyGPTsTitle",defaultMessage:"Third-party"},thirdPartyGPTsDescription:{id:"workspaceSettingsOld.thirdPartyGPTsDescription",defaultMessage:"Manage whether members can use GPTs created outside your workspace."},customActionsTooltip:{id:"workspaceSettingsOld.customActionsTooltip",defaultMessage:"Allow GPTs to use third-party services for tasks such as finding flights. Actions are defined by GPT builders."},searchTooltip:{id:"workspaceSettingsOld.searchTooltip",defaultMessage:"Web search allows ChatGPT and GPTs to answer questions on recent topics. When enabled, it may send search queries and general location information to Bing, but this data is not linked to or associated with user accounts."},customActionsOptionTitle:{id:"workspaceSettingsOld.pluginsOptionTitle.0",defaultMessage:"Custom actions"},appearanceTitle:{id:"workspaceSettingsOld.appearanceTitle",defaultMessage:"Appearance"},sharingSettingsTitle:{id:"workspaceSettingsOld.sharingSettingsTitle",defaultMessage:"Sharing"},gptSharingTitle:{id:"workspaceSettingsOld.gptSharingTitle",defaultMessage:"GPTs can be shared with..."},workspaceMembersOnlySelect:{id:"workspaceSettingsOld.workspaceMembersOnlySelect",defaultMessage:"Workspace members only"},anyOneSelect:{id:"workspaceSettingsOld.anyOneSelect",defaultMessage:"Anyone"},inviteOnlySelect:{id:"workspaceSettingsOld.inviteOnlySelect",defaultMessage:"Invite only"},featureSettingsUpdateFailed:{id:"workspaceSettingsOld.featureSettingsUpdateFailed",defaultMessage:"Failed to update feature setting"},conversationRetention:{id:"workspaceSettingsOld.conversationRetention",defaultMessage:"Chat retention"},retentionInfinite:{id:"workspaceSettingsOld.retentionInfinite",defaultMessage:"Infinite"},retentionNinetyDays:{id:"workspaceSettingsOld.retentionNinetyDays",defaultMessage:"90 days"},retentionOneYear:{id:"workspaceSettingsOld.retentionOneYear",defaultMessage:"1 year"},retentionCustomDays:{id:"workspaceSettingsOld.retentionCustomDays",defaultMessage:"{num} days"},retentionChange:{id:"workspaceSettingsOld.retentionChange",defaultMessage:"Contact your account manager to change this setting."},enterpriseUpsellPill:{id:"workspaceSettingsOld.enterpriseUpsellPill",defaultMessage:"Enterprise"},retentionSettingTooltip:{id:"workspaceSettingsOld.retentionSettingTooltip",defaultMessage:"Contact your account manager to change this setting"},enterpriseRequiredMessage:{id:"workspaceSettingsOld.enterpriseRequiredMessage",defaultMessage:"Only workspaces with the Enterprise plan can change these settings"},shareRecipientTitlePrivate:{id:"workspaceSettingsOld.shareRecipientTitlePrivate",defaultMessage:"Private"},shareRecipientTitleLink:{id:"workspaceSettingsOld.shareRecipientTitleLink",defaultMessage:"Link"},shareRecipientTitlePublic:{id:"workspaceSettingsOld.shareRecipientTitlePublic",defaultMessage:"Public"},thisFeatureDisabledForOrg:{id:"workspaceSettings.thisFeatureDisabledForOrg",defaultMessage:"This feature is disabled in HIPAA compliant workspaces"}}),pt=Le(function(){const s=is();return ns(),e.jsx(Gs,{...s})});export{pt as default};
//# sourceMappingURL=dpetbyabp5p48hi7.js.map
