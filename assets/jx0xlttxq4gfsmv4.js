import{kg as S,ag as w,aG as y,j6 as b}from"./dc2xxjkicf2pz0mj.js";import{P as M,j as e,ah as k,h as N,e as C,u as F,a as W,M as u}from"./juy90og0wtbp77qa.js";import{bU as A,bV as P,W as R,i as U,bW as T}from"./ckp56qklot786ulr.js";import{R as D,I as r,S as l}from"./dmc9t6rhwrqiprl2.js";import{E as I,R as O,g as B}from"./ohs5avdlswoud02a.js";import{u as L}from"./g1nyehepirv7u2n9.js";import{W as $}from"./fwb02vgq072qdb93.js";import"./dbwyrqqzg9g7f2ct.js";import"./jla4ypiufxg3g5ib.js";import"./fkdark0ezkwwm12s.js";import"./lptwpbjabrvjmhsj.js";import"./g9y1jm4dp5lewf3d.js";import"./mia7txooqhkpbw7w.js";import"./o46eutw3gegbydjq.js";import"./jbze7lwlszm657iq.js";import"./h0zoartyn6ddtvom.js";import"./f5uxfkqdhg7743lt.js";import"./na95db8kfrfbx9l9.js";import"./hibpneehm1q4hc2e.js";import"./iacposgqe14fuloa.js";import"./o6wb3ptvu0bk81yq.js";import"./dmfmxszxfbs8gsbx.js";import"./o7zrzew6ugefv8n2.js";import"./abebcwj1m9mup3z6.js";import"./nqj34k5dky4x5suq.js";import"./hort3ndd4wla0a2j.js";import"./jsgl3b1bt1ozctr5.js";import"./ck00y48d3yzt8bq3.js";import"./hczymk9ojq2shlcf.js";import"./dta0gs41e2vxh1q9.js";import"./g8shiwm7jpd74xmd.js";import"./btouzu0b6h5eiejj.js";import"./hisrfv493df9w8hp.js";import"./iiyyoj0wgh5vo89i.js";import"./mwysfro98kbgaaol.js";function q(){const{environmentId:s}=M(),{eligible:i}=A();return i?e.jsx(k,{to:"/codex/onboarding"}):s?e.jsx(z,{environmentId:s}):e.jsx(S,{})}function z({environmentId:s}){const i=N(),o=w(),g=C(),m=F(),{data:n,isLoading:h,isError:v}=P(s),d=n?.secrets??{},x=L()?"workspace":"private",{mutate:E,isPending:f}=W({mutationFn:t=>R.updateEnvironment(s,t),onSuccess:async t=>{await U(m,s),T(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function _(t){const a=B(t.secrets,d),j=t.envVars.reduce((c,p)=>(c[p.key]=p.value,c),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:j,image_snapshot_settings:t.imageSnapshotSettings})}return e.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(y,{})}):v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(u,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):n?e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"sticky top-0 px-4",children:[e.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(l,{}),e.jsx(r,{label:n.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),e.jsx(l,{}),e.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),e.jsx(I,{initialEnvironmentId:s,existingEnvironment:n,initialValues:{label:n?.label,description:n?.description??"",share_settings:n?.share_settings??x,machine:n?.machine_id,repositoryId:n?.repos[0],workspaceDirectory:n?.workspace_dir??"",agentNetworkAccess:n?.agent_network_access,setupCommands:n?.setup?Array.isArray(n?.setup)?n.setup.join(`
`):n.setup:"",envVars:Object.entries(n?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(d).map(t=>({key:t,value:O,isEditing:!1})),imageSnapshotSettings:n?.image_snapshot_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:_,isPending:f})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(u,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const ke=()=>[{title:"Codex"}],Ne=b(function(){return e.jsx(q,{})});export{Ne as default,ke as meta};
//# sourceMappingURL=jx0xlttxq4gfsmv4.js.map
