import{r as g,j as p,h as T}from"./juy90og0wtbp77qa.js";import{dM as M,s as l,N as d,e as C,f as x,bC as k}from"./dc2xxjkicf2pz0mj.js";import{CoTChunks as _}from"./ffbf421byc4smlsp.js";import{hO as h}from"./ckp56qklot786ulr.js";import"./dsi8v49vpimk6dsy.js";import"./dta0gs41e2vxh1q9.js";import"./aqif0rbyaiq9x43t.js";import"./kd37t55r0pqrdrzh.js";import"./dmfmxszxfbs8gsbx.js";import"./f5x7owcyj5iwmbsb.js";import"./llrie03z1kvfi4vu.js";import"./o6wb3ptvu0bk81yq.js";import"./jsgl3b1bt1ozctr5.js";import"./pc2givv05uuq8g6l.js";import"./dq2hdjj12gdqq0p1.js";import"./ezqsz68yx4uzdtqb.js";import"./mre9dehcylnm0d4q.js";import"./ck00y48d3yzt8bq3.js";import"./h9ri4w2fyqo4qlva.js";import"./gn1kkezdsm9hi3t4.js";import"./pbl95wx6493wq92j.js";import"./nvghkpv0zy449sx8.js";const y=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const n=Math.floor(t/60),o=t%60;return`${n}m ${o}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},E=e=>{let t=0;for(const n of e)t+=n.metadata?.finished_duration_sec??0;return t},R=(e,t,n)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:y(e,n)}):M(t)?.metadata?.finished_text??"",I=(e,t,n=!1)=>{const o=[];let s={type:h.Thought,thought:{summary:"",content:""}};const a=()=>{s.thought.content.trim()&&(o.push(s),s={type:h.Thought,thought:{summary:s.thought.summary,content:""}})},u=e.split(/( {2}\n)|(\n\n)/).filter(c=>c!=null&&c.trim());if(!n&&u.length<2)return o;let i=!1;for(let c=0;c<u.length;c++){const r=u[c].trim();if(r.toLowerCase()==="none"){l.count(d.COT_SUMMARIZER,"num_none_chunks");continue}const f=r.match(/^\*\*(.*)\*\*$/);if(f)a(),s.thought.summary=f[1]??"";else if(r){if(r.startsWith("```")){if(i){s.thought.content+=s.thought.content?`
${r}`:r,a(),i=!1;continue}a(),i=!0}s.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!i&&a(),s.thought.content+=s.thought.content?`
${r}`:r}}return s?.thought.content.trim()&&o.push(s),n&&t&&o.push({type:h.Recap,content:t}),o},N=(e,t,n)=>{const o=!n,s=g.useMemo(()=>I(e,t,o),[e,t,o]);return g.useEffect(()=>{o&&l.hist(d.COT_SUMMARIZER,"num_cot_chunks",void 0,s.length)},[o]),s},O=({isStreaming:e,finishedText:t,summaryText:n,isFinalAssistantTurn:o})=>{const s=N(n,t,e);return p.jsx(_,{isStreaming:e,isFinalAssistantTurn:o,chunks:s})},S=8,j=`

`,Y=({messages:e,isStreaming:t,isFinalAssistantTurn:n})=>{const o=T(),s=C(),a=x(s,"1214379119"),u=E(e);let i="";return e.forEach(c=>{const m=k(c);i+=i?j+m:m}),a&&!t&&!i&&u<S?null:p.jsx(O,{finishedText:R(o,e,u),summaryText:i,isStreaming:t,isFinalAssistantTurn:n})};export{O as LegacyCoT,Y as LegacyCoTMessage};
//# sourceMappingURL=n25idv7047m23x6y.js.map
