import{r as P,h as _,j as t,f as B}from"./juy90og0wtbp77qa.js";import{e as H,b6 as W,bd as $,f9 as k,n as q,gK as K,f7 as V,ar as h,aG as D,gb as J,e0 as U}from"./dc2xxjkicf2pz0mj.js";import{eK as b,eL as Q,eM as X,eN as Y,eA as Z,eO as ee,eP as se}from"./ckp56qklot786ulr.js";import{u as ae}from"./o7zrzew6ugefv8n2.js";import"./dmfmxszxfbs8gsbx.js";function te({asset:s,contextConnectorSourceUrl:d,disableExpandable:i=!1,isSingle:l,isUserTurn:u,className:o}){const a=H(),c=W(a).flags,[f,e]=P.useState(!1),{isUnauthenticated:n}=$(),m=c?.includes(k.NoAuthEnableFileUploads),S=q(s.asset_pointer),r=b.useState(O=>b.selectFile(O,S)),p=Q(r?.file??null,r?.file.name,r?.fileId??void 0,r?.gizmoId,r?.contextConnectorInfo,!0),F=n&&r&&m,{gizmoEditorData:w}=K(),M=X(),T=V(u),{isOpen:E}=ae(),C=_(),{data:R,isLoading:z,error:G}=Y({asset:s,gizmoId:w?.id,getServerUrl:!F}),{url:j,width:x,height:I}=p&&m?{width:s.width,height:s.height,url:p}:R??{},A=z||!f,N=x&&I?{Landscape:x>I,Portrait:x<I}:void 0,g=["overflow-hidden rounded-lg"];if(l&&(g.push("w-full h-full"),N?.Landscape?g.push("max-w-96 max-h-64"):N?.Portrait?g.push("max-h-96 max-w-64"):g.push("max-w-64 max-h-64")),o&&g.unshift(o),T)return null;let v;return j!=null&&(v=t.jsx(Z,{alt:C.formatMessage(L.imageAltText),className:h(E?"max-w-[88px]":"max-w-full",!l&&"aspect-square","object-cover object-center",g),src:j,width:x,height:I,onLoad:()=>e(!0)}),!M&&!i&&(v=t.jsx(ee,{src:j,alt:C.formatMessage(L.imageAltText),contextConnectorSourceUrl:d,className:h(g),children:v}))),t.jsx("div",{className:h(g),children:t.jsx("div",{className:h("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!l&&"aspect-square"),children:j!=null?v:t.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${x} / ${I}`,width:x},title:A?C.formatMessage(L.loadingImage):C.formatMessage(L.errorLoadingImage),children:A?t.jsx(D,{}):G?t.jsx(J,{className:"icon-sm"}):null})})})}const L=B({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function y({assets:s,attachments:d,isUserTurn:i=!0,clientThreadId:l}){const u=s.length===1,{containerClassname:o,imageClassnames:a}=y.computeClassnames(s.length);let c=U.ATTACHMENT;return s&&!(d&&d.length>0)&&(c=U.IMAGE),t.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[t.jsx("div",{className:h("flex flex-row items-center justify-end gap-1",o),children:s.map((f,e)=>{const n=d?.find(m=>m.id&&f.asset_pointer.includes(m.id));return t.jsx(te,{asset:f,isSingle:u,isUserTurn:i,contextConnectorSourceUrl:n?.context_connector_info?.source_url,className:a[e]},e)})}),t.jsx(se,{featureType:c,isUserTurn:i,clientThreadId:l})]})}y.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let d=s>=4?"flex-wrap":"";const i=Array(s),l=e=>{i.fill(e)},u=e=>{d+=` ${e}`},o=(e,n)=>{i[e]=h(i[e],n)},a=s<=4&&s%2===0?2:3,c=Math.ceil(s/a),f=s%a!==0;a===2?(l("h-32 w-32"),u("max-w-72")):c<=2?(l("h-24 w-24 sm:h-32 sm:w-32"),u("max-w-80 sm:max-w-100")):(l("h-16 w-16"),u("max-w-52"));for(let e=0;e<s;e++){const n=Math.floor(e/a),m=e%a,S=Math.min(s-n*a,a),r=n===0,p=n===c-1,F=n===c-2,w=m===0,M=m===S-1;r&&w&&o(e,"rounded-ss-2xl"),r&&M&&o(e,"rounded-se-2xl"),p&&w&&o(e,"rounded-es-2xl"),p&&M&&o(e,"rounded-ee-sm"),f&&w&&F&&o(e,"rounded-es-2xl")}return{containerClassname:d,imageClassnames:i}};export{y as TextMessageImageGroup};
//# sourceMappingURL=o7u09mtvo0vxhoqd.js.map
