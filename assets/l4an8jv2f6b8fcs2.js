import{ag as G,a5 as B,p as Q,iE as q,hb as z,dv as V,aG as Z,eW as K,B as X,l5 as Y,dG as $,ar as L,j6 as J}from"./dc2xxjkicf2pz0mj.js";import{j as e,M as o,e as ee,p as ne,u as se,h as te,r as ae,b as re,a as ie,ak as oe,ah as le}from"./juy90og0wtbp77qa.js";import{W as y,i as me,M as ce,a5 as s,i2 as de,i3 as ue,ep as he,bU as pe}from"./ckp56qklot786ulr.js";import{u as fe}from"./g1nyehepirv7u2n9.js";import{E as v}from"./jtc7ne2a6scrj9t5.js";import{W as xe}from"./fwb02vgq072qdb93.js";import"./hibpneehm1q4hc2e.js";import"./iacposgqe14fuloa.js";import"./o6wb3ptvu0bk81yq.js";import"./dmfmxszxfbs8gsbx.js";import"./o7zrzew6ugefv8n2.js";import"./abebcwj1m9mup3z6.js";import"./nqj34k5dky4x5suq.js";import"./hort3ndd4wla0a2j.js";import"./jsgl3b1bt1ozctr5.js";import"./ck00y48d3yzt8bq3.js";import"./hczymk9ojq2shlcf.js";import"./dta0gs41e2vxh1q9.js";import"./g8shiwm7jpd74xmd.js";import"./btouzu0b6h5eiejj.js";import"./hisrfv493df9w8hp.js";import"./iiyyoj0wgh5vo89i.js";import"./mwysfro98kbgaaol.js";import"./o46eutw3gegbydjq.js";import"./jbze7lwlszm657iq.js";import"./h0zoartyn6ddtvom.js";function ge(){return e.jsx("div",{className:"border-token-border-heavy flex items-center border-b",children:e.jsx("div",{className:"py-2 text-xl leading-7 font-medium",children:e.jsx(o,{id:"wham.environmentsHeader.message",defaultMessage:"Environments"})})})}const ve=25,je=100;function we({isPinned:t,onToggle:c,intl:u,isCreator:l}){return e.jsx(s.Cell,{className:"content-center pe-1!",children:e.jsx($,{side:"bottom",align:"center",className:"block w-full",alignOffset:0,label:l?t?e.jsx(o,{id:"wham.environmentsList.unpin",defaultMessage:"Unpin environment for everyone in your workspace"}):e.jsx(o,{id:"wham.environmentsList.pin",defaultMessage:"Pin environment to the top for everyone in your workspace"}):e.jsx(o,{id:"wham.environmentsList.pin.notCreator",defaultMessage:"You can only pin and unpin environments you created."}),children:e.jsxs("button",{disabled:!l,onClick:c,className:L("group/cell relative flex h-10 w-full items-center px-4 group-hover/row:opacity-100",!t&&"opacity-0",t&&!l&&"opacity-50"),"aria-label":t?u.formatMessage({id:"wham.environmentsList.unpinEnvironment",defaultMessage:"Unpin environment"}):u.formatMessage({id:"wham.environmentsList.pinEnvironment",defaultMessage:"Pin environment"}),children:[t&&e.jsx(ue,{className:"icon absolute opacity-0 group-hover/cell:opacity-100"}),e.jsx(he,{className:L("icon absolute",t&&"opacity-100 group-hover/cell:opacity-0")})]})})})}function Ce(){const t=ee(),[c,u]=ne(),l=se(),r=te(),S=G(),p=B(),j=!!p?.isWorkspaceAccount(),w=fe(),[f,P]=ae.useState(c.get("search")??""),{data:k,isLoading:_,error:H,fetchNextPage:I,hasNextPage:C,isFetchingNextPage:T}=re({queryKey:["wham","environments","with-creators"],initialPageParam:null,queryFn:({pageParam:n})=>y.getEnvironmentWithCreators(n?je:ve,n),getNextPageParam:n=>n.cursor??null}),{mutate:D}=ie({mutationFn:({environmentId:n,isPinned:a})=>(l.setQueryData(["wham","environments","with-creators"],i=>i&&Q(i,m=>{for(const g of m.pages)for(const d of g.items)if(d.id===n){d.is_pinned=!d.is_pinned;break}})),l.setQueryData(["wham","environments"],i=>i&&i.map(m=>m.id===n?{...m,is_pinned:a}:m)),y.updateEnvironment(n,{is_pinned:a})),onSettled:()=>{me(l)},onError:()=>{S.danger(r.formatMessage({id:"wham.environmentsList.failedToPinEnvironment",defaultMessage:"Failed to pin environment"}))}}),{isConnected:W,isLoading:A}=q(V.GITHUB_CONNECTOR,"github","/codex/settings/environments",z.CODEX);if(_)return e.jsx("div",{className:"flex h-full items-center justify-center pt-5",children:e.jsx(Z,{})});const M=k?.pages.flatMap(n=>n.items)??[],x=f.trim().toLowerCase(),F=M.filter(n=>n.label.toLowerCase().includes(x)),N=n=>{const a=n.toLowerCase();return a===x?0:a.startsWith(x)?1:2},b=F.slice().sort((n,a)=>{if(n.is_pinned!==a.is_pinned)return n.is_pinned?-1:1;const i=N(n.label)-N(a.label);return i!==0?i:n.label.localeCompare(a.label)});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row justify-between pb-4",children:[e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx(K,{name:"search-environments",color:"search",containerInputClassName:"w-full",className:"text-token-text-primary flex h-8 w-full items-center rounded-md!",value:f,onChange:n=>{const a=n.target.value;P(a),a?u({search:a},{replace:!0}):u({},{replace:!0})},placeholder:r.formatMessage({id:"wham.environmentsList.searchEnvironmentsPlaceholder",defaultMessage:"Search environments"}),ariaLabel:r.formatMessage({id:"wham.environmentsList.searchEnvironmentsAria",defaultMessage:"Search environments"})})}),e.jsx(X,{onClick:()=>t("/codex/settings/environment/create"),disabled:A||!W,color:"primary",icon:ce,className:"h-8","aria-label":r.formatMessage({id:"wham.environmentsList.createEnvironmentAriaLabel",defaultMessage:"Link to create a new environment"}),children:e.jsx("span",{className:"hidden md:inline",children:e.jsx(o,{id:"wham.environmentsList.createEnvironment",defaultMessage:"Create environment"})})})]}),H?e.jsx(v,{title:r.formatMessage({id:"wham.environmentsList.error",defaultMessage:"Failed to load environments"}),description:r.formatMessage({id:"wham.environmentsList.errorDescription",defaultMessage:"Please try refreshing the page, if that does not work, please contact support."})}):M.length===0?e.jsx(v,{title:r.formatMessage({id:"wham.environmentsList.noEnvironments",defaultMessage:"No environments"}),description:r.formatMessage({id:"wham.environmentsList.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})}):e.jsxs(e.Fragment,{children:[e.jsxs(s.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[e.jsxs(s.Header,{children:[e.jsx(s.HeaderCell,{className:"ps-2 text-sm",children:e.jsx(o,{id:"wham.environmentsList.name",defaultMessage:"Name"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.repo",defaultMessage:"Repo"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.numberOfTasks",defaultMessage:"Number of tasks"})}),w&&e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.sharing",defaultMessage:"Sharing"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.creator",defaultMessage:"Creator"})}),e.jsx(s.HeaderCell,{className:"text-sm",children:e.jsx(o,{id:"wham.environmentsList.createdAt",defaultMessage:"Created at"})}),j&&e.jsx(s.HeaderCell,{}),e.jsx(s.HeaderCell,{})]}),e.jsx(s.Body,{children:b.length===0&&!C?e.jsx(s.Row,{children:e.jsx(s.Cell,{colSpan:100,children:e.jsx(v,{title:r.formatMessage({id:"wham.environmentsList.search.noEnvironments",defaultMessage:"No matches for {search}"},{search:f}),description:r.formatMessage({id:"wham.environmentsList.search.noEnvironmentsDescription",defaultMessage:"Create an environment for Codex to work in"})})})}):b.map(({id:n,label:a,is_pinned:i,repos:m,repo_map:g,creator:d,created_at:E,task_count:U,share_settings:R})=>{const O=!!p?.authUserId&&d.id.includes(p?.authUserId);return e.jsxs(s.Row,{role:"row",className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm hover:cursor-pointer",onClick:()=>t(`/codex/settings/environment/${n}`),tabIndex:0,"aria-label":r.formatMessage({id:"wham.environmentsList.environmentAriaLabel",defaultMessage:"View environment {label}"},{label:a}),children:[e.jsx(s.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:a}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:m.map(h=>e.jsx("div",{children:g?.[h]?.repository_full_name??h},h))}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:U}),w&&e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:Me(r,R)}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:d.email}),e.jsx(s.Cell,{divClassName:"flex h-14 items-center",children:E?e.jsx(oe,{value:new Date(E*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(o,{id:"wham.environmentsList.na",defaultMessage:"N/A"})}),j&&e.jsx(we,{isPinned:i,isCreator:O,onToggle:h=>{h.stopPropagation(),D({environmentId:n,isPinned:!!i})},intl:r})]},n)})})]}),e.jsx(de,{isFetchingNextPage:T,hasNextPage:C??!1,fetchNextPage:I})]})]})})}function Me(t,c){switch(c){case"public":return t.formatMessage({id:"wham.environmentsList.public",defaultMessage:"Public"});case"private":return t.formatMessage({id:"wham.environmentsList.private",defaultMessage:"Private"});case"workspace":return t.formatMessage({id:"wham.environmentsList.workspace",defaultMessage:"Workspace"});default:Y.assertNever(c)}}function Ne(){const{eligible:t}=pe();return t?e.jsx(le,{to:"/codex/onboarding"}):e.jsx(xe,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-4 ps-4 pe-4 md:pe-12",children:[e.jsx(ge,{}),e.jsx(Ce,{})]})})}const Xe=()=>[{title:"Codex"}],Ye=J(function(){return e.jsx(Ne,{})});export{Ye as default,Xe as meta};
//# sourceMappingURL=l4an8jv2f6b8fcs2.js.map
