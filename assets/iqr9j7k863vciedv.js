import{r as c,j as e,M as u,f as R,m as y,A as M}from"./juy90og0wtbp77qa.js";import{ax as B,av as S,aw as N,d2 as C,aD as k,aA as O,B as w,e$ as D,kA as E,ec as I,ar as F,D as U}from"./dc2xxjkicf2pz0mj.js";import{hC as h,hD as v,fd as Y,hE as L,hF as p}from"./ckp56qklot786ulr.js";const _=(t,o,i)=>{const r=t.reduce((n,m)=>{const g=new Int16Array(n.length+m.length);return g.set(n,0),g.set(m,n.length),g},new Int16Array),d=r.length*2,l=new ArrayBuffer(44+d),s=new DataView(l);b(s,0,"RIFF"),s.setUint32(4,36+d,!0),b(s,8,"WAVE"),b(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,i,!0),s.setUint32(24,o,!0),s.setUint32(28,o*i*2,!0),s.setUint16(32,i*2,!0),s.setUint16(34,16,!0),b(s,36,"data"),s.setUint32(40,d,!0);let a=44;for(let n=0;n<r.length;n++,a+=2)s.setInt16(a,r[n],!0);return l},b=(t,o,i)=>{for(let r=0;r<i.length;r++)t.setUint8(o+r,i.charCodeAt(r))},z=c.forwardRef(function({sampleRate:o=24e3,channels:i=1,...r},d){const l=c.useRef(null),s=c.useRef([]),a=c.useRef(null);return c.useImperativeHandle(d,()=>({appendBuffer(n){const m=new Int16Array(n);s.current.push(m);const g=_(s.current,o,i),x=new Blob([g],{type:"audio/wav"}),j=URL.createObjectURL(x);l.current&&(a.current&&URL.revokeObjectURL(a.current),l.current.src=j,a.current=j)}})),e.jsx("audio",{ref:l,...r})}),H=c.memo(z);function T({step:t,total:o}){return e.jsx(y.div,{className:"h-1 bg-black transition-all delay-250 duration-1000",initial:{width:0},animate:{width:`${Math.min(t/o*100,100)}%`}})}function W({onClose:t}){const{back:o}=v();return e.jsxs("div",{className:"flex justify-between p-2",children:[e.jsx(w,{size:"small",color:"ghost",icon:Y,className:"size-8",onClick:()=>{o()}}),e.jsx(w,{size:"small",color:"ghost",icon:D,className:"size-8",onClick:t})]})}function V({paragen:t,shouldShowFinishButton:o}){const i=c.useRef(null),[r,d]=c.useState(null),{addFormContents:l}=v(),s=c.useCallback(a=>{a.preventDefault(),r&&l({selectedParagenId:t.id,review:r})},[l,r,t]);return c.useEffect(()=>{i.current&&i.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[]),e.jsxs(y.form,{ref:i,layout:!0,className:"mx-10 flex max-w-max snap-center flex-col justify-center gap-8",initial:{opacity:0,translateY:"1em"},animate:{opacity:1,translateY:0,transition:{duration:.5,delay:.4}},children:[e.jsx("h3",{className:"text-lg whitespace-nowrap",children:e.jsx(u,{...f.formHeader})}),e.jsxs(p.Root,{className:"flex flex-col gap-3 ps-3",onValueChange:a=>{d(a)},children:[e.jsx(p.Item,{value:"clearer_sound",label:e.jsx(u,{...f.formResponseSound}),children:e.jsx(p.Indicator,{})}),e.jsx(p.Item,{value:"smoother_delivery",label:e.jsx(u,{...f.formResponseDelivery}),children:e.jsx(p.Indicator,{})}),e.jsx(p.Item,{value:"better_accent",label:e.jsx(u,{...f.formResponseAccent}),children:e.jsx(p.Indicator,{})}),e.jsx(p.Item,{value:"more_expressive",label:e.jsx(u,{...f.formResponseExpressive}),children:e.jsx(p.Indicator,{})}),e.jsx(p.Item,{value:"other",label:e.jsx(u,{...f.formResponseOther}),children:e.jsx(p.Indicator,{})})]}),e.jsx(w,{size:"medium",className:"w-fit",onClick:s,children:o?e.jsx(u,{...f.formButtonFinish}):e.jsx(u,{...f.formButtonNext})})]})}function A({index:t,paragen:o,isSelected:i,isPrevious:r,isNew:d,shouldDelayAnimation:l}){const s=c.useRef(null),{addSelected:a}=v(),n=h(x=>x.paragens.find(j=>j.id===o.id)?.audioAssetPointer===void 0),m=h(x=>x.paragens.find(j=>j.id===o.id)?.data??[]),g=c.useRef(0);return c.useEffect(()=>{const x=m.length,j=s.current;j&&x>g.current&&(m.slice(g.current,x).forEach(P=>{j.appendBuffer(P.buffer)}),g.current=x)},[m]),e.jsxs(y.div,{layout:!0,className:F("flex snap-center flex-col items-center justify-center gap-8 rounded-3xl px-10 pt-15 pb-15 shadow-[0px_0px_50px_5px_rgba(0,_0,_0,_0.1)] md:w-sm lg:w-md",i&&"ring-2 ring-blue-400"),initial:{opacity:0,translateY:"1em"},animate:{opacity:1,translateY:0,transition:{duration:.75,delay:l?.5+t*.2:.25}},children:[r&&e.jsx("h3",{className:"text-token-text-secondary text-lg",children:e.jsx(u,{...f.paragenOptionPrevious})}),d&&e.jsx("h3",{className:"text-token-text-secondary text-lg",children:e.jsx(u,{...f.paragenOptionNew})}),!r&&!d&&e.jsx("h3",{className:"text-token-text-secondary text-lg",children:"Â "}),e.jsx("img",{src:"https://persistent.oaistatic.com/voice/voice-orb.webp",alt:"Orb logo",className:"size-48"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(H,{ref:s,controls:!0,controlsList:"nodownload noplaybackrate",className:"h-10"}),e.jsx(w,{loading:n,disabled:i??n,size:"medium",onClick:()=>{a(o.id)},className:"transition-opacity",children:e.jsx(u,{...f.paragenOptionButton})})]})]})}function $({messageIds:t}){const{addBothBad:o}=v(),i=h(d=>d.paragens.some(l=>t.includes(l.id)&&l.audioAssetPointer===void 0)),r=c.useCallback(()=>{if(t.length!==2){U.addError(`Expected exactly two message IDs to mark as both bad, received ${t.length}`);return}o(t[0],t[1])},[o,t]);return e.jsx(y.div,{initial:{opacity:0,translateY:"1em"},animate:{opacity:1,translateY:0,transition:{duration:.5,delay:1}},exit:{opacity:0,translateY:"1em"},children:e.jsx(w,{size:"medium",color:"secondary",className:"bg-gray-50 hover:bg-gray-100",onClick:r,disabled:i,children:e.jsx(u,{...f.paragenOptionBothBad})})})}function G(){const t=h(a=>{const n=a.selected.at(-1);return n?a.paragens.find(m=>m.id===n):void 0}),o=h(a=>L(a,t,a.selected.length)),i=h(a=>a.selected.length>a.formContents.length),r=h(a=>a.selected.length===a.paragens.length-1),[d,l]=c.useState(0),s=E(a=>a.windowWidth);return I(()=>{if(s>=768){l(0);return}const m=(s-380)/2;l(m)},[s]),e.jsxs(y.div,{exit:{opacity:0,translateY:"1em"},className:"flex w-full flex-col items-center gap-2",children:[e.jsx("h2",{children:e.jsx(u,{...f.modalHeader})}),e.jsx("p",{className:"text-token-text-secondary text-lg",children:e.jsx(u,{...f.modalDescription})}),e.jsx("div",{className:"no-scrollbar flex w-full snap-x snap-mandatory flex-row gap-5 overflow-x-scroll py-10 md:justify-center md:gap-10 lg:gap-20",style:{paddingLeft:`${d}px`,paddingRight:`${d}px`},children:t&&i?e.jsxs(e.Fragment,{children:[e.jsx(A,{index:0,paragen:t,isSelected:!0},t.id),e.jsx(V,{paragen:t,shouldShowFinishButton:r})]}):o.map((a,n)=>e.jsx(A,{index:n,paragen:a,isPrevious:t&&t.id===a.id,isNew:t&&t.id!==a.id,shouldDelayAnimation:!t},a.id))}),!i&&e.jsx($,{messageIds:o.map(a=>a.id)})]})}function Q({onClose:t,messageId:o}){const i=h(n=>n.bad.length?n.paragens.length:n.formContents.length+1),r=h(n=>n.paragens.length),d=h(n=>n.bad.length>0||n.selected.length===n.paragens.length-1&&n.selected.length===n.formContents.length),{submitParagenResults:l,setShouldShowThankYouTooltip:s}=v(),a=B()?.document.body;return c.useEffect(()=>{let n;return d&&(l(o),n=window.setTimeout(()=>{s(!0),t()},2e3)),()=>{window.clearTimeout(n)}},[o,d,t,l,s]),e.jsx(S,{open:!0,children:e.jsxs(N,{container:a,children:[e.jsx(C,{asChild:!0,children:e.jsx(k,{children:e.jsx(u,{...f.modalHeader})})}),e.jsx(O,{asChild:!0,onEscapeKeyDown:t,children:e.jsxs(y.div,{className:"bg-token-main-surface-primary fixed inset-0 z-50 overflow-hidden focus:outline-hidden",initial:{opacity:0,translateY:"1em"},animate:{opacity:1,translateY:0,transition:{duration:.5}},exit:{opacity:0,translateY:"1em"},children:[e.jsx(T,{step:i,total:r}),e.jsx(W,{onClose:t}),e.jsx("div",{className:"flex h-full w-full justify-center overflow-y-auto",children:e.jsx(M,{mode:"wait",children:!d&&e.jsx(G,{},"modal-content")})})]})})]})})}const f=R({modalHeader:{id:"AudioParagenModal.modalHeader",defaultMessage:"Which response do you prefer?"},modalDescription:{id:"AudioParagenModal.modalDescription",defaultMessage:"Your choice will help make ChatGPT better."},paragenOptionPrevious:{id:"AudioParagenModal.paragenOptionPrevious",defaultMessage:"Previous response"},paragenOptionNew:{id:"AudioParagenModal.paragenOptionNew",defaultMessage:"New response"},paragenOptionButton:{id:"AudioParagenModal.paragenOptionButton",defaultMessage:"I prefer this response"},paragenOptionBothBad:{id:"AudioParagenModal.paragenOptionBothBad",defaultMessage:"Both are bad"},formHeader:{id:"AudioParagenModal.formHeader",defaultMessage:"Tell us a little more about your choice"},formResponseSound:{id:"AudioParagenModal.formResponseSound",defaultMessage:"Clearer sound"},formResponseDelivery:{id:"AudioParagenModal.formResponseDelivery",defaultMessage:"Smoother delivery"},formResponseAccent:{id:"AudioParagenModal.formResponseAccent",defaultMessage:"Better accent"},formResponseExpressive:{id:"AudioParagenModal.formResponseExpressive",defaultMessage:"More expressive"},formResponseOther:{id:"AudioParagenModal.formResponseOther",defaultMessage:"Other"},formButtonNext:{id:"AudioParagenModal.formButtonNext",defaultMessage:"Next"},formButtonFinish:{id:"AudioParagenModal.formButtonFinish",defaultMessage:"Finish"}});export{Q as AudioParagenModal};
//# sourceMappingURL=iqr9j7k863vciedv.js.map
